<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dokumen Pengangkutan</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB"
      crossorigin="anonymous"
    />

    <style>
      :root {
        font-size: 8px;
      }
      body {
        margin: 20px 25px;
        font-family: Calibri, Arial, Helvetica, sans-serif;
      }

      th,
      td {
        padding-block: 0 !important;
      }

      .document-content {
        /* padding: 0.8cm; */
        page-break-after: always;
      }

      .document-content:last-of-type {
        page-break-after: auto;
      }

      /* Tabel Penawaran */
      .penawaran-table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 15px;
        /* font-size: 9pt; */
      }

      .penawaran-table th,
      .penawaran-table td {
        border: 1px solid #000;
        padding: 6px 8px;
      }

      .penawaran-table th {
        background-color: #8ed7e0;
      }

      .penawaran-table .row-number {
        text-align: center;
        width: 30px;
      }

      .green-header {
        background-color: #82d065 !important;
      }

      .blue-header {
        background-color: #9dd8f0 !important;
      }

      /* Signature Box */
      .signature-table .signature-content {
        height: 80px;
      }

      /* Notes Section */
      .notes-section {
        font-size: 9pt;
        margin-top: 10px;
      }

      .notes-section ol {
        padding-left: 20px;
        margin-bottom: 5px;
      }

      .yellow-highlight {
        background-color: #ffff00;
      }

      .blue-highlight {
        background-color: #6ab3e4 !important;
      }

      .green-highlight {
        background-color: #b9e5c4 !important;
      }

      .border-table {
        border: 1px solid #000;
      }

      .border-table:not(:last-child) {
        border-bottom: 0;
      }

      .flex-column:not(:last-of-type) > .border-table {
        border-right: 0;
      }

      .vendor-list {
        display: grid;
        grid-template-columns: repeat(5, minmax(0, 1fr));
        overflow: hidden;
      }

      .vendor-item {
        display: flex;
        border: 1px solid #000;
      }

      .vendor-item-no {
        width: 2.2rem;
        text-align: center;
        border-right: 1px solid #000;
        padding: 4px 2px;
        font-weight: 600;
      }

      .vendor-item-name {
        flex: 1;
        padding: 4px 6px;
        font-size: 1rem;
        line-height: 1.4;
      }

      @page {
        size: A4;
        margin: 0;
      }

      @media print {
        body {
          background: white;
        }

        /* .document-content {
          padding: 0.5cm;
        } */
      }
    </style>
  </head>

  <body>
    <div class="document-content">
      <!-- Header -->
      <header class="header-title text-end mb-3">{{ JobName }}</header>

      <!-- Vendor Table -->
      <div class="mb-3">
        <p class="mb-0 fw-semibold fs-6">MM</p>
        {{VendorList}}
      </div>

      <!-- Tagihan & HPS -->
      <div class="mb-3">
        <div class="row g-0">
          <div class="col-8 pe-2">
            <div class="fw-bold p-1 border border-black border-bottom-0 green-header">Tagihan ke PDC</div>
            <table class="table table-bordered border-black">
              <thead>
                <tr class="text-center">
                  <th scope="col" style="width: 1.5rem">No</th>
                  <th class="text-start" scope="col" style="width: 20rem">Item</th>
                  <th scope="col" style="width: 2rem">Quantity</th>
                  <th scope="col" style="width: 7rem">Tarif 400 km</th>
                  <th scope="col" style="width: 6rem">Tarif Add</th>
                  <th scope="col" style="width: 9rem">KM per 25 Km</th>
                  <th scope="col" style="width: 11rem">Nilai Penambahan</th>
                  <th scope="col" style="width: 7rem">Jumlah</th>
                </tr>
              </thead>
              <tbody>
                {{ PnlItemsTable }}
                <tr>
                  <td colspan="7">Total Tagihan</td>
                  <td class="text-end"><strong>{{ TotalRevenue }}</strong></td>
                </tr>
              </tbody>
            </table>
          </div>

          <div class="col-4 ps-3">
            <table class="table table-bordered border-black">
              <thead>
                <tr class="text-center">
                  <td colspan="2">Keterangan</td>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>No WO</td>
                  <td class="text-end">{{ Wonum }}</td>
                </tr>
                <tr>
                  <td>Tanggal WO</td>
                  <td class="text-end">01/08/2025</td>
                </tr>
                <tr>
                  <td>Tanggal Terima WO</td>
                  <td class="text-end">04/08/2025</td>
                </tr>
                <tr>
                  <td>Vendor</td>
                  <td class="text-end">{{ SelectedVendorName }}</td>
                </tr>
                <tr>
                  <td>Profit/Loss</td>
                  <td class="text-end">{{ Profit }}</td>
                </tr>
                <tr>
                  <td>Status Pekerjaan</td>
                  <td class="text-end">OPEN</td>
                </tr>
                <tr>
                  <td>Jarak</td>
                  <td class="text-end">{{ Distance }} KM</td>
                </tr>
                <tr>
                  <td>Tanggal PNL</td>
                  <td class="text-end">{{ PnlCreatedAt }}</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Penawaran PT Cahaya Mulia -->
      {{ VendorOfferTable }}

      <!-- Profit & Los Estimate -->
      {{ PnlEstimateTable }}

      <!-- Signature Table -->
      <table class="signature-table table table-bordered border-black">
        <tbody class="text-center">
          <tr>
            <td style="width: 33.33%">Dibuat oleh :</td>
            <td style="width: 33.33%">Disetujui oleh :</td>
            <td style="width: 33.33%">Disetujui oleh :</td>
          </tr>
          <tr>
            <td class="signature-content"></td>
            <td class="signature-content"></td>
            <td class="signature-content"></td>
          </tr>
          <tr>
            <td>Dirayanto</td>
            <td>Edo Pradipta</td>
            <td>Arfinal Diputra</td>
          </tr>
          <tr>
            <td>Analyst HTE & LTS</td>
            <td>Assistant Manager HTE</td>
            <td>Manager Transport & Logistic</td>
          </tr>
        </tbody>
      </table>

      <!-- Notes -->
      <div class="notes-section">
        <ol>
          <li>
            Penawaran RFI Total {{ SelectedVendorCount }} ({{ SelectedVendorCountTerbilang }}) vendor dari total {{
            VendorCount }} Mitra PDC
          </li>
          <li class="yellow-highlight">
            Dari Harga paling rendah yaitu {{ SelectedVendorName }} dengan Estimasi Profit Sebesar Rp{{ Profit }} atau
            {{ ProfitPercent }} %
          </li>
          <li><strong>Actual</strong> Invoice disesuaikan dengan Surat Jalan</li>
          <li>
            Diserahkan kebutuhan yg mendesak dan mitra terkait sudah berpengalaman di PDC serta telah memiliki SRT dan
            CSMS untuk pekerjaan ini tidak diperpanjangan Jaminan Pelaksanaan"
          </li>
        </ol>
      </div>
    </div>
  </body>
</html>
