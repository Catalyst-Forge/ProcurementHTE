@using ProcurementHTE.Core.Models
@model Vendor

@{
    ViewData["Title"] = "Edit Vendor";
}

<div class="d-flex justify-content-between align-items-center mb-3 border-bottom pb-2">
    <h1 class="h3 mb-0">Edit Vendor</h1>
    <a asp-action="Index" class="btn btn-secondary">
        <i class="bi bi-arrow-left-circle"></i> Back to List
    </a>
</div>

<form asp-action="Edit" method="post" asp-antiforgery="true" novalidate>
    <div asp-validation-summary="ModelOnly" class="text-danger small mb-3"></div>

    <input type="hidden" asp-for="VendorId" />
    <!-- Kalau action Edit-mu masih bind VendorCode, hidden ini memastikan nilainya tidak hilang -->
    <input type="hidden" asp-for="VendorCode" />

    <!-- Vendor Info -->
    <div class="card mb-3">
        <div class="card-header fw-semibold">Vendor Info</div>
        <div class="card-body">
            <div class="row g-3">
                <div class="col-md-4">
                    <label class="form-label">Vendor Code</label>
                    <input class="form-control-plaintext" value="@Model.VendorCode" readonly />
                    <div class="form-text">Auto-generated • not editable</div>
                </div>
                <div class="col-md-8">
                    <label asp-for="VendorName" class="form-label"></label>
                    <input asp-for="VendorName" class="form-control" />
                    <span asp-validation-for="VendorName" class="text-danger small"></span>
                </div>
                <div class="col-md-6">
                    <label asp-for="NPWP" class="form-label"></label>
                    <input asp-for="NPWP" class="form-control" maxlength="255" placeholder="99.999.999.9-999.999" />
                    <span asp-validation-for="NPWP" class="text-danger small"></span>
                </div>
            </div>
        </div>
    </div>

    <!-- Address -->
    <div class="card mb-3">
        <div class="card-header fw-semibold">Address</div>
        <div class="card-body">
            <div class="row g-3">
                <div class="col-12">
                    <label asp-for="Address" class="form-label"></label>
                    <input asp-for="Address" class="form-control" maxlength="200" />
                    <span asp-validation-for="Address" class="text-danger small"></span>
                </div>
                <div class="col-md-4">
                    <label asp-for="City" class="form-label"></label>
                    <input asp-for="City" class="form-control" />
                    <span asp-validation-for="City" class="text-danger small"></span>
                </div>
                <div class="col-md-4">
                    <label asp-for="Province" class="form-label"></label>
                    <input asp-for="Province" class="form-control" />
                    <span asp-validation-for="Province" class="text-danger small"></span>
                </div>
                <div class="col-md-4">
                    <label asp-for="PostalCode" class="form-label"></label>
                    <input asp-for="PostalCode" class="form-control" inputmode="numeric" pattern="\d*" />
                    <span asp-validation-for="PostalCode" class="text-danger small"></span>
                </div>
            </div>
        </div>
    </div>

    <!-- Contact -->
    <div class="card mb-3">
        <div class="card-header fw-semibold">Contact</div>
        <div class="card-body">
            <div class="row g-3">
                <div class="col-md-6">
                    <label asp-for="Email" class="form-label"></label>
                    <input asp-for="Email" type="email" class="form-control" placeholder="vendor@example.com" />
                    <span asp-validation-for="Email" class="text-danger small"></span>
                </div>
                <div class="col-md-6">
                    <label asp-for="PhoneNumber" class="form-label"></label>
                    <input asp-for="PhoneNumber" class="form-control" inputmode="tel" placeholder="+62..." />
                    <span asp-validation-for="PhoneNumber" class="text-danger small"></span>
                </div>
                <div class="col-md-6">
                    <label asp-for="ContactPerson" class="form-label"></label>
                    <input asp-for="ContactPerson" class="form-control" />
                    <span asp-validation-for="ContactPerson" class="text-danger small"></span>
                </div>
                <div class="col-md-6">
                    <label asp-for="ContactPosition" class="form-label"></label>
                    <input asp-for="ContactPosition" class="form-control" />
                    <span asp-validation-for="ContactPosition" class="text-danger small"></span>
                </div>
            </div>
        </div>
    </div>

    <!-- Status & Notes -->
    <div class="card mb-3">
        <div class="card-header fw-semibold">Status & Notes</div>
        <div class="card-body">
            <div class="row g-3">
                <div class="col-md-4">
                    <label asp-for="Status" class="form-label"></label>
                    <!-- Prefer asp-items; pastikan controller Edit GET mengisi ViewBag.Statuses -->
                    <select asp-for="Status" class="form-select" asp-items="ViewBag.Statuses">
                        <option value="">-- Select Status --</option>
                    </select>
                    <span asp-validation-for="Status" class="text-danger small"></span>
                </div>
                <div class="col-md-8">
                    <label asp-for="Comment" class="form-label"></label>
                    <textarea asp-for="Comment" class="form-control" maxlength="200" rows="3" placeholder="Optional notes..."></textarea>
                    <span asp-validation-for="Comment" class="text-danger small"></span>
                </div>
            </div>
        </div>
    </div>

    <div class="d-flex gap-2">
        <button type="submit" class="btn btn-primary">
            <i class="bi bi-check2-circle"></i> Save
        </button>
        <a asp-action="Index" class="btn btn-outline-secondary">Cancel</a>
    </div>
</form>

@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
    <script>
        // UX: paksa hanya digit untuk PostalCode
        document.addEventListener('input', function (e) {
          if (e.target.matches('[name="PostalCode"]')) {
            e.target.value = e.target.value.replace(/[^\d]/g, '');
          }
        });
    </script>
}
