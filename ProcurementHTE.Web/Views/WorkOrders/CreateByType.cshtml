@model ProcurementHTE.Core.Models.WorkOrder
@{
    ViewData["Title"] = "Buat Work Order";
    var partialName = ViewBag.CreatePartial as string ?? "_CreateOther";
    var woTypeName = ViewBag.SelectedWoTypeName as string ?? "Other";
}

<h2 class="mb-1">@ViewData["Title"]</h2>
<p class="text-muted mb-4">Tipe: <span class="fw-semibold">@woTypeName</span></p>

<div class="card shadow-sm">
  <div class="card-body">
    <form asp-action="Create" method="post" enctype="multipart/form-data">
      @Html.AntiForgeryToken()
      @* Hidden supaya WoTypeId tetap terbawa *@
      <input type="hidden" asp-for="WoTypeId" />
      
      @* Dropdown status & lain-lain (pakai ViewData dari controller) *@
      <div class="row g-3 mb-3">
        <div class="col-md-6">
          <label asp-for="StatusId" class="form-label"></label>
          <select asp-for="StatusId" class="form-select" asp-items="@(ViewData["StatusId"] as SelectList)">
            <option value="">-- pilih status --</option>
          </select>
          <span asp-validation-for="StatusId" class="text-danger"></span>
        </div>
        <div class="col-md-6">
          <label class="form-label">Procurement Type</label>
          <select asp-for="ProcurementType" class="form-select">
            @{
              var enums = (Array)ViewData["EnumProcurementTypes"];
              foreach (var e in enums)
              {
                <option value="@((int)e)">@e.ToString()</option>
              }
            }
          </select>
        </div>
      </div>

      @* Form spesifik per tipe (reuse partial lama) *@
      @await Html.PartialAsync(partialName, Model)

      <div class="d-flex gap-2 mt-4">
        <a asp-action="SelectType" class="btn btn-outline-secondary">Kembali</a>
        <button type="submit" class="btn btn-primary">Simpan</button>
      </div>
    </form>
  </div>
</div>

@section Scripts{
  <partial name="_ValidationScriptsPartial" />
}
